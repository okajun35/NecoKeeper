# デフォルトロケール環境変数化プラン（保留中）

> 状態: 実施保留（他機能優先のため、必要になった際に着手）

デプロイごとにコードを書き換えず、日本語と英語の初期言語を切り替えられるよう、デフォルトロケールを環境設定で管理するための検討メモです。

## 実装手順

1. `app/config.py` に `default_locale` 設定を追加し、`.env` から読み込みつつ `AppConfig` で参照できるようにする。環境変数が未設定または取得できない場合は `'ja'` を採用し、取得した値が `ja` / `en` 以外なら `'ja'` にフォールバックさせる。
2. `app/templates/admin/base.html` など基底テンプレートへ `config.default_locale` を渡し、データ属性やインラインスクリプト経由でフロントへ伝搬させる。
3. `app/static/js/i18n.js` で保存済み言語が無い場合にサーバー提供のデフォルトを利用するよう調整し、既存のフォールバック処理は維持する。
4. `app/utils/i18n.py` やロケールを受け取るサービス層で、ハードコードした `'ja'` ではなく設定値を初期値として扱うようにし、想定外のロケール値が渡された場合は `'ja'` へフォールバックする。
5. `tests/utils/test_i18n.py` などロケール関連テストおよびドキュメント・環境変数サンプルを最新の仕様に合わせて更新する。

## 検討事項

1. 環境変数には `ja` / `en` のみを許容し、それ以外が来たら `'ja'` に丸める方針を実装する。
2. 初回アクセス時にバックエンドがデフォルト値でロケールクッキーを即設定する運用とし、言語状態を早期にフロントと共有できるようにする。
